import{I as j,u as y,r as a,j as e}from"./vendor-2e0792b2.js";import{a as N,S as b,s as v}from"./index-97c69941.js";import{I as k}from"./ImageCarousel-a57e97b1.js";function E(){const{id:r}=j(),x=y(),{addToCart:m}=N(),[t,u]=a.useState(null),[g,p]=a.useState(!0),[o,i]=a.useState(null),[n,h]=a.useState(1);a.useEffect(()=>{async function c(){try{const{data:s,error:d}=await v.from("products").select(`
            *,
            category_ref:categories(id, name),
            anime:anime(id, name)
          `).eq("id",r).single();if(d)throw d;if(!s){i("Producto no encontrado");return}u(s)}catch(s){console.error("Error fetching product:",s),i(s.message||"Error al cargar el producto")}finally{p(!1)}}r&&c()},[r]);const f=()=>{t&&m({...t,quantity:n})},l=c=>{if(!t)return;const s=Math.max(1,Math.min(n+c,t.stock));h(s)};return g?e.jsx("div",{className:"flex justify-center items-center h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-orange-500"})}):o?e.jsxs("div",{className:"flex justify-center items-center h-screen text-red-500",children:[e.jsx("p",{children:o}),e.jsx("button",{onClick:()=>x("/"),className:"ml-4 px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600",children:"Volver al inicio"})]}):t?e.jsxs("div",{className:"container mx-auto px-4 py-8",children:[e.jsx(b,{title:`${t.name} - GATOTAKU`,description:t.description||`Detalles del producto ${t.name}`}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8",children:[e.jsx("div",{children:e.jsx(k,{images:t.images,alt:t.name})}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:t.name}),t.anime&&e.jsxs("p",{className:"text-gray-600",children:["Anime: ",t.anime.name]}),t.category_ref&&e.jsxs("p",{className:"text-gray-600",children:["CategorÃ­a: ",t.category_ref.name]}),e.jsxs("p",{className:"text-2xl font-bold text-orange-500",children:["$",t.price.toFixed(2)]}),e.jsx("p",{className:"text-gray-700",children:t.description}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>l(-1),className:"bg-gray-200 px-3 py-1 rounded",children:"-"}),e.jsx("span",{className:"text-xl",children:n}),e.jsx("button",{onClick:()=>l(1),className:"bg-gray-200 px-3 py-1 rounded",children:"+"})]}),e.jsx("button",{onClick:f,disabled:t.stock===0,className:`px-6 py-2 rounded text-white ${t.stock===0?"bg-gray-400 cursor-not-allowed":"bg-orange-500 hover:bg-orange-600"}`,children:t.stock===0?"Sin stock":"Agregar al carrito"})]}),e.jsxs("p",{className:"text-gray-500",children:["Stock disponible: ",t.stock]})]})]})]}):null}export{E as default};
